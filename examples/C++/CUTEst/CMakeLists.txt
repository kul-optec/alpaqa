find_package(MASTSIF REQUIRED)

cutest_sif_problem(BIGGSC4 ALL)
cutest_sif_problem(CLEUVEN2 ALL)
cutest_sif_problem(CLEUVEN3 ALL)
cutest_sif_problem(CLEUVEN4 ALL)
cutest_sif_problem(CLEUVEN5 ALL)
cutest_sif_problem(CLEUVEN6 ALL)
cutest_sif_problem(CLEUVEN7 ALL)
cutest_sif_problem(S268 ALL)
cutest_sif_problem(READING6 ALL)
cutest_sif_problem(SIMPLLPB ALL)
cutest_sif_problem(A0ENDNDL ALL)
cutest_sif_problem(AGG ALL)
cutest_sif_problem(GOFFIN ALL)
cutest_sif_problem(MODEL ALL)
cutest_sif_problem(PDE1 SUFFIX "-3" OPTIONS "-param" "N=3" ALL)
cutest_sif_problem(PDE1 SUFFIX "-299" OPTIONS "-param" "N=299" ALL)
# cutest_sif_problem(PDE1 SUFFIX "-2999" OPTIONS "-param" "N=2999" ALL) # 27 million constraints

set(PROBLEMS_THESIS "3PK" "A4X12" "ACOPP14" "ACOPP30" "ACOPR14" "AIRCRFTA" "AIRPORT" "ALLINITA" "ALLINITC" "ALSOTAME" "ANTWERP" "AVION2" "BATCH" "BRITGAS" "BT13" "C-RELOAD" "CANTILVR" "CONCON" "CORE2" "CRESC50" "DALLASM" "DALLASS" "DECONVBNE" "DECONVC" "DECONVNE" "DECONVU" "DEGENLPA" "DEGENLPB" "DEMBO7" "DISC2" "DISCS" "DNIEPER" "EQC" "ERRINBAR" "EXPLIN" "EXPLIN2" "EXPQUAD" "FCCU" "FEEDLOC" "FLETCHER" "FLOSP2TM" "GAUSSELM" "GILBERT" "GRIDGENA" "GRIDNETA" "GRIDNETI" "GROUPING" "HADAMARD" "HANGING" "HELSBY" "HIMMELBI" "HIMMELBJ" "HIMMELBK" "HIMMELP1" "HIMMELP2" "HIMMELP3" "HIMMELP4" "HIMMELP5" "HIMMELP6" "HOLMES" "HONG" "HS101" "HS102" "HS103" "HS104" "HS105" "HS106" "HS107" "HS108" "HS109" "HS110" "HS111" "HS112" "HS114" "HS116" "HS117" "HS119" "HS13" "HS15" "HS16" "HS17" "HS18" "HS19" "HS2" "HS20" "HS21MOD" "HS23" "HS24" "HS25" "HS25NE" "HS2NE" "HS30" "HS31" "HS32" "HS33" "HS34" "HS36" "HS37" "HS38" "HS4" "HS41" "HS45" "HS5" "HS54" "HS55" "HS57" "HS59" "HS60" "HS62" "HS63" "HS64" "HS65" "HS66" "HS67" "HS68" "HS69" "HS70" "HS71" "HS72" "HS73" "HS74" "HS75" "HS80" "HS81" "HS83" "HS84" "HS85" "HS86" "HS87" "HS93" "HS95" "HS96" "HS97" "HS98" "HS99" "HS99EXP" "HUBFIT" "HVYCRASH" "HYDROELL" "HYDROELM" "HYDROELS" "INTEGREQ" "JANNSON3" "JANNSON4" "JUNKTURN" "KISSING2" "KTMODEL" "LAKES" "LAUNCH" "LEAKNET" "LEWISPOL" "LIN" "LINSPANH" "LOADBAL" "LOOTSMA" "LSNNODOC" "LSQFIT" "LUKVLI5" "MANNE" "MARINE" "MATRIX2" "MCONCON" "MESH" "MINC44" "MINPERM" "MINSURFO" "MISTAKE" "MODEL" "MRIBASIS" "NGONE" "NUFFIELD" "NYSTROM5" "ODFITS" "PFIT1" "PFIT2" "PFIT3" "PFIT4" "PORTFL1" "PORTFL2" "PORTFL3" "PORTFL4" "PORTFL6" "PRODPL0" "PRODPL1" "QC" "QCNEW" "READING7" "RES" "RK23" "ROBOT" "ROTDISC" "S365" "S365MOD" "S368" "SCOND1LS" "SMBANK" "SMMPSF" "SPANHYD" "SUPERSIM" "SWOPF" "SYNTHES1" "SYNTHES2" "SYNTHES3" "TRUSPYR1" "TRUSPYR2" "TRY-B" "TWIRISM1" "TWOBARS" "WACHBIEG" "WATER" "YORKNET" "ZAMB2-10" "ZAMB2-11" "ZAMB2-8" "ZAMB2-9" "ZECEVIC3" "ZECEVIC4" "ZIGZAG" "ZY2")
set(PROBLEMS_LP "AGG" "DEGENLPA" "DEGENLPB" "EXTRASIM" "GOFFIN" "MAKELA4" "MODEL" "OET1" "OET3" "PDE1" "PDE2" "PT" "READING2" "S277-280" "SIMPLLPA" "SIMPLLPB" "SIPOW1" "SIPOW1M" "SIPOW2" "SIPOW2M" "SIPOW3" "SIPOW4" "SSEBLIN" "SUPERSIM" "TFI2")
set(PROBLEMS_LP_NETLIB "25FV47" "80BAU3B" "ADLITTLE" "AFIRO" "AGG2" "AGG3" "AGG" "BANDM" "BEACONFD" "BLEND" "BNL1" "BNL2" "BOEING1" "BOEING2" "BORE3D" "BRANDY" "CAPRI" "CRE-A" "CRE-B" "CRE-C" "CRE-D" "CYCLE" "CZPROB" "D2Q06C" "D6CUBE" "DEGEN2" "DEGEN3" "DFL001" "E226" "ETAMACRO" "FFFFF800" "FINNIS" "FIT1D" "FIT1P" "FIT2D" "FIT2P" "FORPLAN" "GANGES" "GFRD-PNC" "GREENBEA" "GREENBEB" "GROW15" "GROW22" "GROW7" "ISRAEL" "KB2" "KEN-07" "KEN-11" "KEN-13" "KEN-18" "LOTFI" "MAROS-R7" "MAROS" "MODSZK1" "NESM" "OSA-07" "OSA-14" "OSA-30" "OSA-60" "PDS-02" "PDS-06" "PDS-10" "PDS-20" "PEROLD" "PILOT4" "PILOT87" "PILOT-JA" "PILOTNOV" "PILOT" "PILOT-WE" "QAP12" "QAP15" "QAP8" "RECIPELP" "SC105" "SC205" "SC50A" "SC50B" "SCAGR25" "SCAGR7" "SCFXM1" "SCFXM2" "SCFXM3" "SCORPION" "SCRS8" "SCSD1" "SCSD6" "SCSD8" "SCTAP1" "SCTAP2" "SCTAP3" "SEBA" "SHARE1B" "SHARE2B" "SHELL" "SHIP04L" "SHIP04S" "SHIP08L" "SHIP08S" "SHIP12L" "SHIP12S" "SIERRA" "STAIR" "STANDATA" "STANDGUB" "STANDMPS" "STOCFOR1" "STOCFOR2" "STOCFOR3" "TRUSS" "TUFF" "VTP-BASE" "WOOD1P" "WOODW")
list(REMOVE_ITEM PROBLEMS_LP_NETLIB ${PROBLEMS_LP})
set(PROBLEMS_QP "A0ENDNDL" "A0ENINDL" "A0ENSNDL" "A0ESDNDL" "A0ESINDL" "A0ESSNDL" "A0NNDNDL" "A0NNDNIL" "A0NNDNSL" "A0NNSNSL" "A0NSDSDL" "A0NSDSDS" "A0NSDSIL" "A0NSDSSL" "A0NSSSSL" "A2ENDNDL" "A2ENINDL" "A2ENSNDL" "A2ESDNDL" "A2ESINDL" "A2ESSNDL" "A2NNDNDL" "A2NNDNIL" "A2NNDNSL" "A2NNSNSL" "A2NSDSDL" "A2NSDSIL" "A2NSDSSL" "A2NSSSSL" "A5ENDNDL" "A5ENINDL" "A5ENSNDL" "A5ESDNDL" "A5ESINDL" "A5ESSNDL" "A5NNDNDL" "A5NNDNIL" "A5NNDNSL" "A5NNSNSL" "A5NSDSDL" "A5NSDSDM" "A5NSDSIL" "A5NSDSSL" "A5NSSNSM" "A5NSSSSL" "ALLINQP" "AUG2D" "AUG2DC" "AUG2DCQP" "AUG2DQP" "AUG3D" "AUG3DC" "AUG3DCQP" "AUG3DQP" "AVGASA" "AVGASB" "BDRY2" "BIGGSC4" "BLOCKQP1" "BLOCKQP2" "BLOCKQP3" "BLOCKQP4" "BLOCKQP5" "BLOWEYA" "BLOWEYB" "BLOWEYC" "BTS4" "CBS" "CLEUVEN2" "CLEUVEN3" "CLEUVEN4" "CLEUVEN5" "CLEUVEN6" "CLEUVEN7" "CMPC1" "CMPC10" "CMPC11" "CMPC12" "CMPC13" "CMPC14" "CMPC15" "CMPC16" "CMPC2" "CMPC3" "CMPC4" "CMPC5" "CMPC6" "CMPC7" "CMPC8" "CMPC9" "CONT5-QP" "CVXQP1" "CVXQP2" "CVXQP3" "DALE" "DEGENQP" "DEGENQPC" "DEGTRIDL" "DTOC3" "DUAL1" "DUAL2" "DUAL3" "DUAL4" "DUALC1" "DUALC2" "DUALC5" "DUALC8" "FERRISDC" "FIVE20B" "FIVE20C" "GENHS28" "GMNCASE1" "GMNCASE2" "GMNCASE3" "GMNCASE4" "GOULDQP1" "GOULDQP2" "GOULDQP3" "HATFLDH" "HIE1327D" "HIE1372D" "HIER13" "HIER133A" "HIER133B" "HIER133C" "HIER133D" "HIER133E" "HIER16" "HIER163A" "HIER163B" "HIER163C" "HIER163D" "HIER163E" "HS118" "HS21" "HS268" "HS35" "HS35I" "HS35MOD" "HS44" "HS44NEW" "HS48" "HS51" "HS52" "HS53" "HS76" "HS76I" "HUES-MOD" "HUESTIS" "JJTABEL3" "KSIP" "LEUVEN1" "LEUVEN2" "LEUVEN3" "LEUVEN4" "LEUVEN5" "LEUVEN6" "LEUVEN7" "LINCONT" "LISWET1" "LISWET10" "LISWET11" "LISWET12" "LISWET2" "LISWET3" "LISWET4" "LISWET5" "LISWET6" "LISWET7" "LISWET8" "LISWET9" "LOTSCHD" "MOSARQP1" "MOSARQP2" "MPC1" "MPC10" "MPC11" "MPC12" "MPC13" "MPC14" "MPC15" "MPC16" "MPC2" "MPC3" "MPC4" "MPC5" "MPC6" "MPC7" "MPC8" "MPC9" "NASH" "NCVXQP1" "NCVXQP2" "NCVXQP3" "NCVXQP4" "NCVXQP5" "NCVXQP6" "NCVXQP7" "NCVXQP8" "NCVXQP9" "NINE12" "NINE5D" "NINENEW" "OSORIO" "PORTSNQP" "PORTSQP" "POWELL20" "PRIMAL1" "PRIMAL2" "PRIMAL3" "PRIMAL4" "PRIMALC1" "PRIMALC2" "PRIMALC5" "PRIMALC8" "QPBAND" "QPCBLEND" "QPCBOEI1" "QPCBOEI2" "QPCSTAIR" "QPNBAND" "QPNBLEND" "QPNBOEI1" "QPNBOEI2" "QPNSTAIR" "RDW2D51F" "RDW2D51U" "RDW2D52B" "RDW2D52F" "RDW2D52U" "S268" "SOSQP1" "SOSQP2" "STATIC3" "STCQP1" "STCQP2" "STNQP1" "STNQP2" "TABLE1" "TABLE3" "TABLE4" "TABLE5" "TABLE6" "TABLE7" "TABLE8" "TAME" "TARGUS" "TOYSARAH" "TWO5IN6" "TWOD" "UBH1" "YAO" "ZECEVIC2")
list(REMOVE_ITEM PROBLEMS_QP "HIER133B" "HIER133C" "HIER163B" "HIER163C" "HIER163E" "TABLE4" "TABLE5") # these are listed in the documentation, but don't actually exist
set(PROBLEMS_QP_MM "AUG2DCQP" "AUG2DC" "AUG2DQP" "AUG2D" "AUG3DCQP" "AUG3DC" "AUG3DQP" "AUG3D" "BOYD1" "BOYD2" "CONT-050" "CONT-100" "CONT-101" "CONT-200" "CONT-201" "CONT-300" "CVXQP1_L" "CVXQP1_M" "CVXQP1_S" "CVXQP2_L" "CVXQP2_M" "CVXQP2_S" "CVXQP3_L" "CVXQP3_M" "CVXQP3_S" "DPKLO1" "DTOC3" "DUAL1" "DUAL2" "DUAL3" "DUAL4" "DUALC1" "DUALC2" "DUALC5" "DUALC8" "EXDATA" "GENHS28" "GOULDQP2" "GOULDQP3" "HS118" "HS21" "HS268" "HS35MOD" "HS35" "HS51" "HS52" "HS53" "HS76" "HUES-MOD" "HUESTIS" "KSIP" "LASER" "LISWET10" "LISWET11" "LISWET12" "LISWET1" "LISWET2" "LISWET3" "LISWET4" "LISWET5" "LISWET6" "LISWET7" "LISWET8" "LISWET9" "LOTSCHD" "MOSARQP1" "MOSARQP2" "POWELL20" "PRIMAL1" "PRIMAL2" "PRIMAL3" "PRIMAL4" "PRIMALC1" "PRIMALC2" "PRIMALC5" "PRIMALC8" "Q25FV47" "QADLITTL" "QAFIRO" "QBANDM" "QBEACONF" "QBORE3D" "QBRANDY" "QCAPRI" "QE226" "QETAMACR" "QFFFFF80" "QFORPLAN" "QGFRDXPN" "QGROW15" "QGROW22" "QGROW7" "QISRAEL" "QPCBLEND" "QPCBOEI1" "QPCBOEI2" "QPCSTAIR" "QPILOTNO" "QPTEST" "QRECIPE" "QSC205" "QSCAGR25" "QSCAGR7" "QSCFXM1" "QSCFXM2" "QSCFXM3" "QSCORPIO" "QSCRS8" "QSCSD1" "QSCSD6" "QSCSD8" "QSCTAP1" "QSCTAP2" "QSCTAP3" "QSEBA" "QSHARE1B" "QSHARE2B" "QSHELL" "QSHIP04L" "QSHIP04S" "QSHIP08L" "QSHIP08S" "QSHIP12L" "QSHIP12S" "QSIERRA" "QSTAIR" "QSTANDAT" "S268" "STADAT1" "STADAT2" "STADAT3" "STCQP1" "STCQP2" "TAME" "UBH1" "VALUES" "YAO" "ZECEVIC2")
list(REMOVE_ITEM PROBLEMS_QP_MM ${PROBLEMS_QP})

function(installed_cutest_sif_problem SUBDIR PROBLEM)
    cutest_sif_problem(${PROBLEM} ${ARGN})
    set_target_properties(cutest-problem-${PROBLEM}
                          PROPERTIES INSTALL_RPATH "$ORIGIN/../..")
    install(TARGETS cutest-problem-${PROBLEM}
            LIBRARY DESTINATION ${ALPAQA_INSTALL_LIBDIR}/CUTEst/${SUBDIR}/${PROBLEM}
            COMPONENT cutest)
    install(FILES "$<TARGET_FILE_DIR:cutest-problem-${PROBLEM}>/OUTSDIF.d"
            DESTINATION ${ALPAQA_INSTALL_LIBDIR}/CUTEst/${SUBDIR}/${PROBLEM}
            COMPONENT cutest)
endfunction()

foreach(PROBLEM IN LISTS PROBLEMS_THESIS)
    installed_cutest_sif_problem(Thesis ${PROBLEM} ALL)
endforeach()

foreach(PROBLEM IN LISTS PROBLEMS_LP)
    installed_cutest_sif_problem(LP ${PROBLEM} ALL)
endforeach()

foreach(PROBLEM IN LISTS PROBLEMS_LP_NETLIB)
    installed_cutest_sif_problem(LP ${PROBLEM} ALL COLLECTION netlib-lp)
endforeach()

foreach(PROBLEM IN LISTS PROBLEMS_QP)
    installed_cutest_sif_problem(QP ${PROBLEM} ALL)
endforeach()

foreach(PROBLEM IN LISTS PROBLEMS_QP_MM)
    installed_cutest_sif_problem(QP ${PROBLEM} ALL COLLECTION maros-meszaros)
endforeach()

get_target_property(CUTEST_LIB CUTEst::cutest IMPORTED_LOCATION)
if (CUTEST_LIBRARY MATCHES ".so$")
    install(FILES ${CUTEST_LIB}
            DESTINATION ${ALPAQA_INSTALL_LIBDIR}/CUTEst
            COMPONENT cutest)
endif()
